#----------------------------------------------------------------------------
# Destination directory for binaries and class libraries
#----------------------------------------------------------------------------
PREFIX  = ../..
LIB_DIR	= $(PREFIX)/lib

OUT		= test_posixopt

#----------------------------------------------------------------------------
# Compiler and linker options.
#----------------------------------------------------------------------------
CC			= gcc
CFLAGS 		= -Wall -g
CPPFLAGS	= -I$(PREFIX)/include

CPICFLAGS	= -fPIC 
LDSOFLAGS	= -G -dy
ARFLAGS		= ruv

LOADLIBES	= 
LDLIBS		= 

AWK			= awk

#----------------------------------------------------------------------------
# Default target.
#----------------------------------------------------------------------------

all: $(OUT)

#----------------------------------------------------------------------------
# Suffix rules
#----------------------------------------------------------------------------

.SUFFIXES: 
.PRECIOUS: .o

%.c: %.awk
	$(AWK) -f $< $*.txt | tee $@

%: %.o
	$(CC) $< $(LOADLIBES) $(LDLIBS) -o $@

%.o: %.c
	$(CC) -c $(CFLAGS) $(CPPFLAGS) $< -o $@

#----------------------------------------------------------------------------
# Build binaries
#----------------------------------------------------------------------------


#----------------------------------------------------------------------------
# others
#----------------------------------------------------------------------------
clean:
	rm -f *.o core core.* $(OUT)
